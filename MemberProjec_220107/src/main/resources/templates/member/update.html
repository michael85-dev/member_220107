<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
</head>
<body>
<h2>update.html</h2>
<form action="/member/update" method="post">
    <input type="hidden" id="memberId" name="memberId" th:value="${member.memberId}"> <br>
    <input type="text" id="memberEmail" name="memberEmail" th:value="${member.memberEmail}" readonly> <br>
    <input type="text" id="memberName" name="memberName" th:value="${member.memberName}"> <br>
    <input type="text" id="memberPassword" name="memberPassword" th:value="${member.memberPassword}"> <br>
    <input type="submit" value="수정">
    <input type="button" value="수정(put)" th:onclick="memberUpdate()">
</form>
</body>
<script>
    // function memberUpdate() {
    //
    // }
    const memberUpdate = () => {
      // 현재 매개변수는 없으므로.
        console.log('수정함수 호출');

        // DOM API를 이용하여 memberId, 이메일, 비번, 이름을 가져와서 각각 javascript 함수에 담으시오.
        // ()안에 member를 넣고 작성하였음. -> 이 방법은 안되는건가?
        // const mId = document.getElementById(member.memberId);
        // const mEmail = document.getElementById(member.memberEmail);
        // const mPassword = document.getElementById(member.memberPassword);
        // const mName = document.getElementById(member.memberPassword);

        // 전부 같은 의미.
        const id = document.getElementById('memberId').value;
        const email = document.querySelector('#memberEmail').value;
        const password = $('#memberPassword').val();
        // const name = '[[${member.memberName}]]'; // DB에서 가지고 온 내용
        const name = document.querySelector('#memberName').value;

        console.log(id, email, password, name);
    // javascript object에 담아서 ajax로 컨트롤러에 보냄.
        const updateData = JSON.stringify({
           memberId: id,
           memberEmail: email,
            memberPassword: password,
            memberName: name
        }); // 컨트롤러로 보내기 위해서 만든 타입
        console.log(updateData);

        const reqUrl = "/member/" + id;

        $.ajax({
            type: 'put', //put : 덮어쓰기, patch : 수정이 필요한 것만 바뀜.
            data: updateData,
            url: reqUrl,
            contentType: 'application/json', //json으로 보낼때는 꼭 써야함.
            success: function() {
                location.href = "/member/" + id;
            },
            error: function() {
                alert('실패');
            }
        });

    }
</script>
</html>